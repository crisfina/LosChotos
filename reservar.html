<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hacer Reserva - Los Chotos</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <main class="contenedor">
        <h2>Nueva Reserva</h2>
        
        <div class="formulario">
            <input type="text" id="nombre" placeholder="Tu nombre">
            <input type="date" id="fecha">
            
            <button id="btnGuardar">Confirmar Reserva</button>
            <a href="index.html" class="boton-secundario">Volver atrás</a>
        </div>
    </main>

    <script type="module">
        // 1. Importamos la conexión desde tu archivo central
        import { db } from './firebase-config.js';
        // 2. Importamos las funciones necesarias de la librería de Firebase
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const btn = document.getElementById('btnGuardar');

        btn.addEventListener('click', async () => {
            const nombre = document.getElementById('nombre').value;
            const fecha = document.getElementById('fecha').value;

            if (nombre && fecha) {
                try {
                    // 3. Guardamos los datos en la colección "reservas"
                    await addDoc(collection(db, "reservas"), {
                        usuario: nombre,
                        fecha: fecha,
                        creado: new Date()
                    });
                    alert("¡Reserva confirmada!");
                    window.location.href = "index.html"; // Redirige al inicio tras guardar
                } catch (error) {
                    console.error("Error al guardar:", error);
                    alert("Hubo un fallo al guardar");
                }
            } else {
                alert("Rellena todos los campos");
            }
        });
    </script>

</body>
</html>
