<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Reservas - Los Chotos</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <main class="contenedor">
        <h2>Próximas Reservas</h2>
        
        <ul id="lista-reservas">
            <p>Cargando reservas...</p>
        </ul>

        <a href="index.html" class="boton-secundario">Volver al inicio</a>
    </main>

    <script type="module">
        // 1. Importamos la conexión central
        import { db } from './firebase-config.js';
        // 2. Importamos las funciones para leer (query, onSnapshot, orderBy)
        import { collection, query, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const listaUI = document.getElementById('lista-reservas');

        // 3. Creamos una consulta ordenada por fecha
        const consulta = query(collection(db, "reservas"), orderBy("fecha", "asc"));

        // 4. Escuchamos los cambios en tiempo real
        onSnapshot(consulta, (snapshot) => {
            listaUI.innerHTML = ""; // Limpiamos la lista antes de llenarla

            if (snapshot.empty) {
                listaUI.innerHTML = "<p>No hay reservas todavía.</p>";
                return;
            }

            snapshot.forEach((doc) => {
                const reserva = doc.data();
                const item = document.createElement('li');
                item.className = "reserva-item";
                item.innerHTML = `
                    <span class="fecha">${reserva.fecha}</span>
                    <span class="nombre">${reserva.usuario}</span>
                `;
                listaUI.appendChild(item);
            });
        });
    </script>

</body>
</html>
